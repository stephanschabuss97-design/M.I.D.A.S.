/**
 * MODULE: assets/css/ui/doctor-view.css
 * Description: Enthält das komplette Layout- und Styling-System für die Arztansicht – inkl. Toolbar, KPI-Badges, Tages-Grid und responsive Spalten.
 * Submodules:
 *  - Toolbar & KPI Badges
 *  - Doctor Day Grid Layout (3-Spalten-Struktur)
 *  - Columns (Date, Measurements, Special)
 *  - Notes Styling
 *  - Responsive Layout (Tablet & Mobile)
 *  - Placeholders & Empty States
 */


/* SUBMODULE: Toolbar & KPI Badges @public - Kopfzeile mit Titel, Datumsauswahl und Tageskennzahlen */
#doctorCard .toolbar,
.doctor-panel .toolbar {
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
  justify-content:space-between; /* Titel links + Mitte + Badges rechts */
  border-bottom:1px solid var(--color-border-subtle);
  padding-bottom:8px;
  margin-bottom:var(--section-header-margin);
}

#doctorCard .toolbar .center-group,
.doctor-panel .toolbar .center-group {
  flex:1;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:center; /* Buttons + Datum + Anwenden mittig */
}

#doctorCard .toolbar .badge,
.doctor-panel .toolbar .badge {
  margin-left:8px;
}

/* SUBMODULE: KPI Badges Styles @public - visuelle Kennzeichnung guter/schlechter Tageswerte */

/* SUBMODULE: Trendpilot Section @public - listet Regel-Hinweise + Aktionen */
.doctor-trendpilot{
  border:1px solid #242833;
  border-radius:var(--radius-md);
  padding:12px 14px;
  margin-bottom:12px;
  background:var(--surface-card);
  box-shadow:var(--shadow-card);
}
.doctor-trendpilot-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  margin-bottom:6px;
}
.doctor-trendpilot-list{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.doctor-trendpilot-empty{
  font-size:var(--text-sm);
  opacity:.75;
  padding:4px 0;
}
.doctor-accordion{
  border:0;
  background:transparent;
}
.doctor-accordion > summary{
  list-style:none;
  cursor:pointer;
}
.doctor-accordion > summary::-webkit-details-marker{
  display:none;
}
.doctor-accordion-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.doctor-accordion-body{
  margin-top:6px;
}
.tp-row{
  border:1px solid #2f3442;
  border-radius:10px;
  padding:10px 12px;
  background:rgba(15,19,29,.9);
  display:flex;
  flex-direction:column;
  gap:8px;
}
@media (min-width:820px){
  .tp-row{
    flex-direction:row;
    align-items:flex-start;
    justify-content:space-between;
  }
  .tp-text{ flex:1; }
}
.tp-meta{
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:8px;
  font-weight:600;
}
.tp-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:2px 8px;
  border-radius:999px;
  font-size:var(--text-xs);
  font-weight:600;
  border:1px solid transparent;
}
.tp-badge.is-warning{
  background:rgba(250,204,21,.12);
  border-color:rgba(250,204,21,.45);
  color:var(--color-warning);
}
.tp-badge.is-critical{
  background:rgba(220,38,38,.12);
  border-color:rgba(220,38,38,.5);
  color:var(--color-danger);
}
.tp-badge.is-info{
  background:rgba(59,130,246,.12);
  border-color:rgba(59,130,246,.35);
  color:var(--color-primary);
}
.tp-ack{
  font-size:var(--text-xs);
  padding:2px 6px;
  border-radius:6px;
  font-weight:600;
}
.tp-ack.is-ack{
  background:rgba(34,197,94,.18);
  color:var(--color-success);
}
.tp-ack.is-open{
  background:rgba(220,38,38,.18);
  color:var(--color-danger);
}
.tp-text{
  font-size:var(--text-sm);
  line-height:1.35;
  color:var(--color-text);
}
.tp-status{
  font-size:var(--text-xs);
  opacity:.8;
}
.tp-actions{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  justify-content:flex-end;
}
.tp-row.is-loading{
  opacity:.6;
  pointer-events:none;
}

/* SUBMODULE: Doctor Day Grid Layout @public - Hauptlayout je Tagesblock (responsive Grid-Struktur) */
.doctor-view .doctor-day{
  display:grid;
  grid-template-columns:1fr; /* Standard = gestapelt */
  gap:12px;
  align-items:start;
  padding:12px 14px;
  margin:8px 0;
  border-radius:var(--radius-md);
  background:var(--surface-card);
  border:1px solid #242833;
  box-shadow:var(--shadow-panel);
  page-break-inside:avoid;
  break-inside:avoid;
}

/* Tablet/Desktop: nebeneinander */
@media (min-width:900px){
  .doctor-view .doctor-day{
    grid-template-columns:18% 46% 36%;
  }
}

@media (min-width:900px){
  .doctor-activity-day{
    grid-template-columns:18% 1fr;
  }
  .doctor-activity-day .col-measure{
    grid-column:2 / -1;
  }
}

/* Zwischenbereich: 2 Spalten */
@media (min-width:600px) and (max-width:899px){
  .doctor-view .doctor-day{
    grid-template-columns:40% 60%;
    grid-template-areas:
      "date measure"
      "date special";
  }
  .doctor-view .col-date{ grid-area:date; }
  .doctor-view .col-measure{ grid-area:measure; }
  .doctor-view .col-special{ grid-area:special; }
}

/* SUBMODULE: Column A (Date) @internal - Datum, Wolkensymbol und Aktionen */
.doctor-view .col-date{
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:center;
  font-weight:800;
  font-size:clamp(16px,1.6vw,20px);
  letter-spacing:.2px;
}
.doctor-view .col-date .date-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.doctor-view .col-date .date-label{
  font-weight:800;
  font-size:clamp(16px,1.6vw,20px);
  letter-spacing:.2px;
}
.doctor-view .col-date .date-cloud{ font-size:var(--text-lg); line-height:1; }
.doctor-view .col-date .date-actions{
  display:flex;
  justify-content:flex-start; /* oder center, wenn du's mittig magst */
}
/* SUBMODULE: Column B (Measurements) @internal - Blutdruck, Puls und MAP */
.doctor-view .col-measure{ display:grid; grid-template-rows:auto 1fr; gap:6px; }
.doctor-view .measure-head,
.doctor-view .measure-grid{
  display:grid;
  grid-template-columns:minmax(70px, auto) repeat(5, 1fr);
  gap:4px;
}
.doctor-view .measure-head{ font-size:var(--text-xs); opacity:.8; }

.doctor-view .measure-head > div{ display:flex; align-items:center; }
.doctor-view .measure-head > div:first-child{ justify-content:flex-start; }
.doctor-view .measure-head > div:not(:first-child){ justify-content:flex-end; }
.doctor-view .measure-row{ display:contents; }
.doctor-view .label{ display:flex; align-items:center; font-size:var(--text-sm); opacity:.9; }

.doctor-body-day .doctor-body-metrics .measure-head,
.doctor-body-day .doctor-body-metrics .measure-grid{
  grid-template-columns:repeat(4, minmax(110px, 1fr));
}
.doctor-body-day .doctor-body-metrics .measure-head > div{
  white-space:nowrap;
  justify-content:center;
  text-align:center;
}
.doctor-body-day .doctor-body-metrics .measure-row .num{
  justify-content:center;
  text-align:center;
}

.doctor-activity-day .doctor-activity-metrics .measure-head,
.doctor-activity-day .doctor-activity-metrics .measure-grid{
  grid-template-columns:repeat(3, minmax(0, 1fr));
}
.doctor-activity-day .doctor-activity-metrics .measure-head > div{
  justify-content:center;
  text-align:center;
}
.doctor-activity-day .doctor-activity-metrics .measure-row .duration-col{
  justify-content:center;
  text-align:center;
}
.doctor-activity-day .doctor-activity-metrics .activity-col,
.doctor-activity-day .doctor-activity-metrics .note-col{
  text-align:center;
  justify-content:center;
  white-space:normal;
  line-height:1.35;
}
.doctor-activity-day .doctor-activity-metrics .note-col{
  font-size:var(--text-sm);
  opacity:.85;
}

/* Zahlenbild */
.doctor-view .num{
  font-variant-numeric:tabular-nums lining-nums;
  -moz-font-feature-settings:"tnum","lnum";
  -webkit-font-feature-settings:"tnum","lnum";
  font-feature-settings:"tnum","lnum";
  text-align:right;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  min-width:4ch; /* Basisschutz gegen Abschneiden */
  white-space:nowrap;
}
.doctor-view .num.alert{ color:var(--color-danger); }

.doctor-view .measure-grid .num,
.doctor-view .col-special .num{
  text-align:right;
  justify-content:flex-end;
}

/* SUBMODULE: Column C (Special Info) @internal - Gewicht, Bauchumfang und Notizen */
.doctor-view .weight-line,
.doctor-view .waist-line{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:4px;
  background:transparent;
  border:none;
  padding:0;
  font-weight:600;
}

.doctor-view .weight-line > :first-child,
.doctor-view .waist-line > :first-child{
  font-size:var(--text-xs);
  opacity:.8;
  font-weight:600;
  letter-spacing:.2px;
}

.doctor-view .weight-line .num,
.doctor-view .waist-line .num{
  font-size:clamp(16px,1.6vw,20px);
  font-weight:700;
  line-height:1.1;
  text-align:center;
}

.doctor-view .col-special{
  display:grid;
  grid-template-columns:minmax(160px, max-content) 1fr;
  column-gap:16px;
  row-gap:6px;
  align-items:start;
}

.doctor-day:not(.doctor-body-day) .col-special{
  display:block;
}

.doctor-view .col-special > .weight-line,
.doctor-view .col-special > .waist-line { grid-column:1; }
.doctor-view .col-special > .notes       { grid-column:2; }

.doctor-view .weight-line .num,
.doctor-view .waist-line .num{ font-variant-numeric:tabular-nums; }

.doctor-view .notes{
  font-size:var(--text-sm);
  line-height:1.35;
  display:-webkit-box;
  line-clamp:3;
  -webkit-line-clamp:3;      /* 3 Zeilen, bei Bedarf 2 setzen */
  -webkit-box-orient:vertical;
  overflow:hidden;
  word-break:break-word;
  padding:0;                 /* kein Box-Feeling */
  background:transparent;
  border:none;
}
.doctor-view .notes::before{
  content:"Kommentar";
  display:block;
  font-size:var(--text-xs);
  opacity:.8;
  font-weight:600;
  letter-spacing:.2px;
  margin-bottom:4px;
}

/* SUBMODULE: Responsive Layout @public - Anpassungen für Tablets und Smartphones */
@media (max-width:599px){
  .doctor-view .measure-head,
  .doctor-view .measure-grid{
    grid-template-columns:minmax(72px, 1fr) repeat(5, minmax(56px, 1fr));
  }
  .doctor-view .measure-head{ font-size:var(--text-xxs); }

  .doctor-view .num{
    min-width:4.5ch; /* ~ "96.7" passt sicher */
    white-space:nowrap;
    flex:0 0 auto;
  }
  .doctor-view .col-special .weight-line .num,
  .doctor-view .col-special .waist-line .num{
    min-width:5ch;
  }

  .doctor-view .col-special{
    grid-template-columns:minmax(110px, max-content) 1fr;
    column-gap:12px;
  }
  .doctor-view .col-special > .notes{
    grid-column:1 / -1;
  }
  .doctor-view .notes{
    line-clamp:4;
    -webkit-line-clamp:4; /* bei Bedarf auf 5 erhoehen */
  }

}

.doctor-lab-day .doctor-lab-metrics .measure-head,
.doctor-lab-day .doctor-lab-metrics .measure-grid{
  grid-template-columns:repeat(3, minmax(90px, 1fr));
}
.doctor-lab-day .doctor-lab-metrics .measure-head > div{
  justify-content:center;
  text-align:center;
}
.doctor-lab-day .doctor-lab-grid .num{
  justify-content:center;
}
.doctor-lab-group{
  margin-bottom:8px;
}
.doctor-lab-group:last-child{
  margin-bottom:0;
}
.doctor-lab-comment{
  padding:8px 0;
}
.doctor-lab-comment-label{
  font-size:var(--text-xs);
  opacity:.8;
  font-weight:600;
  letter-spacing:.2px;
  margin-bottom:4px;
}
.doctor-lab-comment-text{
  font-size:var(--text-sm);
  line-height:1.4;
  word-break:break-word;
}
.doctor-lab-comment-empty{
  opacity:.7;
  font-style:italic;
}

/* SUBMODULE: Placeholders & Empty States @public - Anzeige bei fehlenden Daten oder Sperrzustand */
.u-doctor-placeholder{ text-align:center; opacity:.7; padding:12px; }
.doctor-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}

.doctor-view {
  position: relative;
}

.doctor-tab-panel {
  display: none;
}

.doctor-tab-panel.is-active {
  display: block;
}

body.is-inbox-open {
  overflow: hidden;
}

.doctor-inbox-panel {
  display: flex;
  flex-direction: column;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  width: 100vw;
  height: 100vh;
  max-height: 100vh;
  transform: none;
  background: var(--surface-card, #0f1116);
  border-radius: 0;
  box-shadow: var(--shadow-modal);
}

.doctor-inbox-panel .content {
  padding: 16px;
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;
}

@media (max-width: 720px){
  .doctor-inbox-panel{
    width: 100vw;
    height: 100vh;
  }
  .doctor-inbox-panel .content{
    height: 100%;
    overflow: auto;
  }
}

.doctor-inbox {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.doctor-inbox-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.doctor-inbox-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.doctor-inbox-filters {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin: 8px 0 12px;
}

.doctor-report-card {
  border: 1px solid #242833;
  border-radius: var(--radius-md);
  padding: 14px 16px;
  background: var(--surface-card);
  box-shadow: var(--shadow-card);
}

.doctor-report-head {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 8px;
  font-size: var(--text-sm);
}

.doctor-report-period strong {
  display: block;
  font-size: var(--text-lg);
}

.doctor-report-meta {
  text-align: right;
}

.doctor-report-tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-bottom: 8px;
  padding: 3px 10px;
  border-radius: var(--radius-pill);
  border: 1px solid #2b2f3a;
  font-size: var(--text-xxs);
  font-weight: 700;
  color: var(--color-text-muted);
}

.doctor-report-summary {
  font-weight: 600;
  margin-bottom: 8px;
}

.doctor-report-summary span.report-flag {
  display: inline-block;
  margin-left: 6px;
  padding: 2px 6px;
  border-radius: var(--radius-pill);
  background: var(--color-warning, #f4c15d);
  color: #121417;
  font-size: var(--text-xxs);
  font-weight: 700;
}

.doctor-report-body {
  font-size: var(--text-sm);
  line-height: 1.4;
  opacity: 0.95;
  word-break: break-word;
}

.doctor-report-body .report-empty {
  margin: 0;
  font-style: italic;
  opacity: 0.7;
}

.doctor-report-body p {
  margin: 0 0 6px 0;
}

.doctor-report-body ul {
  margin: 0;
  padding-left: 18px;
}

.doctor-report-body li {
  margin-bottom: 4px;
}

.doctor-report-body > * + * {
  margin-top: 12px;
}

.doctor-report-body ul + p {
  margin-top: 12px;
}

.doctor-report-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 10px;
}

.doctor-report-group-list{
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.doctor-report-group{
  border: 1px solid #242833;
  border-radius: var(--radius-md);
  background: rgba(15, 19, 29, 0.85);
  overflow: hidden;
}

.doctor-report-group > summary{
  list-style: none;
  cursor: pointer;
}

.doctor-report-group > summary::-webkit-details-marker{
  display: none;
}

.doctor-report-group-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 14px;
  font-size: var(--text-sm);
  font-weight: 700;
}

.doctor-report-group-body{
  padding: 12px 14px 14px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.doctor-report-group-label{
  margin: 8px 0 6px;
  font-size: var(--text-xs);
  font-weight: 700;
  opacity: 0.7;
}


@media (min-width: 641px) and (max-width: 900px) {
  .doctor-panel .toolbar {
    flex-direction: column;
    align-items: stretch;
  }

  .doctor-panel .toolbar .center-group {
    justify-content: flex-start;
  }

  .doctor-report-group-list {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 12px;
  }

  .doctor-report-meta {
    text-align: left;
  }

  .doctor-report-actions {
    justify-content: flex-start;
    flex-wrap: wrap;
  }

  .doctor-report-actions .btn {
    flex: 1 1 auto;
  }
}
